{{/* Gallery name should be passed as first parameter */}}
{{- $gallery := .Get 0 -}}
{{/* Create a flex box container for the images */}}
<div 
  class="gallery {{ $gallery }}"
  style="display: flex;">
{{/* Parse out markdown image declarations from `.Inner` and iterate */}}
{{- $parsed_images := findRE "[!][[][^]]*[]][(][^)]+[)]" .Inner -}}
{{/*{{- $image_width := mul 100.0 (div 1.0 (len $parsed_images)) -}}*/}}
{{- range $parsed_images -}}
  {{/* Parse the image URL */}}
  {{- $src := index (findRE "http[^)]+" .) 0 -}}
  {{- $description := replaceRE "[!][[]([^]]*)[]].+" "$1" . }}
  {{/*{{- $link_style := printf "height: 30vh; width: %s%; flex-grow: 1;" $image_width -}}*/}}
  {{/*{{- $img_style := "max-height: 100%; min-height: 100%; min-width: 100%; object-fit: cover; vertical-align: bottom;" -}}*/}}
  {{ partial "lightbox.html" (dict "src" $src "gallery" $gallery  "description" $description "link_class" "gallery-link" "img_class" "gallery-image") }}
{{- end -}}
</div>
